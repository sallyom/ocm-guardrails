# SPIRE Helm Values for OpenClaw A2A Infrastructure
# Chart: spire v0.27.1 (with spire-crds v0.5.0)
# Repo:  https://spiffe.github.io/helm-charts-hardened/
#
# Install:
#   helm install spire-crds spire-crds \
#     --repo https://spiffe.github.io/helm-charts-hardened/ \
#     --version 0.5.0 -n spire-system --create-namespace
#
#   helm install spire spire \
#     --repo https://spiffe.github.io/helm-charts-hardened/ \
#     --version 0.27.1 -n spire-system -f values.yaml

global:
  # Set to true for OpenShift, false for vanilla Kubernetes
  openshift: true
  installAndUpgradeHooks:
    enabled: false
  spire:
    # -- Customize these for your environment --
    trustDomain: demo.example.com
    clusterName: spiffe-demo
    strictMode: false
    caSubject:
      commonName: SPIFFE Demo CA
      country: US
      organization: SPIFFE Demo
    namespaces:
      create: false
      server:
        create: false
        name: spire-server
      system:
        create: false
        name: spire-system

spiffe-csi-driver:
  enabled: true

spiffe-oidc-discovery-provider:
  enabled: false

spire-agent:
  enabled: true
  nameOverride: agent
  hostSocketPath: /run/spire/agent-sockets
  socketPath: /run/spire/agent-sockets/spire-agent.sock
  workloadAttestors:
    k8s:
      skipKubeletVerification: true
      useNewContainerLocator: true
      verboseContainerLocatorLogs: false

spire-server:
  enabled: true
  kind: statefulset
  nameOverride: server
  replicaCount: 1
  controllerManager:
    enabled: true
  podSecurityContext:
    fsGroup: 1000
